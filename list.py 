# ===================================
# LIST.PY - Módulo de listado
# Se ejecuta cuando main.py lo importa con exec()
# ===================================

# --- SUBMENÚ LISTAR (while con break) ---
while True:
    print("\n" + "-" * 30)
    print("LISTAR PACIENTES")
    print("-" * 30)
    print("1. Listar todos")
    print("2. Listar por estado")
    print("3. Volver al menú principal")
    
    list_option = input("\nSelecciona (1-3): ")
    
    # --- LISTAR TODOS ---
    if list_option == "1":
        print("\n" + "=" * 50)
        print("TODOS LOS PACIENTES")
        print("=" * 50)
        
        if len(patients) == 0:
            print("\nNo hay pacientes registrados.")
        else:
            for patient in patients:
                print(f"\n  ID: {patient['id']}")
                print(f"  Nombre: {patient['nombre_completo']}")
                print(f"  Correo: {patient['correo']}")
                print(f"  Teléfono: {patient['telefono']}")
                print(f"  Estado: {patient['estado']}")
                print("  " + "-" * 30)
            
            print(f"\nTotal: {len(patients)} pacientes")
    
    # --- LISTAR POR ESTADO ---
    elif list_option == "2":
        print("\n" + "-" * 30)
        print("FILTRAR POR ESTADO")
        print("-" * 30)
        
        for key, value in patient_states.items():
            print(f"  {key}. {value}")
        
        state_option = input("\nSelecciona estado (1-5): ")
        
        if state_option.isdigit():
            state_option = int(state_option)
            
            if state_option in patient_states:
                selected_state = patient_states[state_option]
                
                print("\n" + "=" * 50)
                print(f"PACIENTES: {selected_state.upper()}")
                print("=" * 50)
                
                count = 0
                
                for patient in patients:
                    if patient["estado"] == selected_state:
                        count += 1
                        print(f"\n  ID: {patient['id']}")
                        print(f"  Nombre: {patient['nombre_completo']}")
                        print(f"  Correo: {patient['correo']}")
                        print(f"  Teléfono: {patient['telefono']}")
                        print("  " + "-" * 30)
                
                if count == 0:
                    print("\nNo hay pacientes con este estado.")
                else:
                    print(f"\nTotal: {count} pacientes")
            
            else:
                print("\n✗ Estado no válido")
        else:
            print("\n✗ Ingresa un número válido")
    
    # --- VOLVER ---
    elif list_option == "3":
        break  # ← BREAK del submenú listar
    
    else:
        print("\n✗ Opción no válida")